class UserController { async register(name, email, password) { try { const hashedPassword = await bcrypt.hash(password, 10); const user = await prisma.user.create({ data: { name, email, password: hashedPassword } }); return user; } catch (err) { throw err; } } async login(email, password) { try { const user = await prisma.user.findUnique({ where: { email } }); if (!user) throw new Error('Invalid email or password'); const isValidPassword = await bcrypt.compare(password, user.password); if (!isValidPassword) throw new Error('Invalid email or password'); const token = jwt.sign({ userId: user.id }, 'secretkey', { expiresIn: '1h' }); return { token }; } catch (err) { throw err; } } }